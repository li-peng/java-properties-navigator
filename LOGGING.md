# Java Properties Navigator - 日志功能说明

## 概述

Java Properties Navigator 扩展现在包含了完善的日志系统，用于记录扩展的运行状态、性能信息和错误详情。

## 日志功能特性

### 1. 多级别日志支持
- **DEBUG**: 详细的调试信息，包括方法调用、变量状态等
- **INFO**: 一般信息，如操作成功、状态变更等
- **WARN**: 警告信息，如配置问题、非致命错误等
- **ERROR**: 错误信息，包括详细的错误堆栈和上下文

### 2. 多输出方式
- **输出通道**: 在VS Code的输出面板中显示（通道名：Java Properties Navigator）
- **控制台**: 可选的控制台输出，便于开发调试

### 3. 性能监控
- 关键操作的执行时间记录
- 索引构建和重建的性能统计
- 文件扫描和解析的时间监控

## 配置选项

在VS Code设置中，可以配置以下日志相关选项：

### `java-properties-navigator.logLevel`
- **类型**: 字符串枚举
- **可选值**: `"DEBUG"`, `"INFO"`, `"WARN"`, `"ERROR"`
- **默认值**: `"INFO"`
- **说明**: 设置日志输出级别，只有等于或高于此级别的日志才会被输出

### `java-properties-navigator.enableConsoleOutput`
- **类型**: 布尔值
- **默认值**: `true`
- **说明**: 是否同时在浏览器控制台输出日志（除了输出通道）

## 主要日志记录点

### 扩展生命周期
- ✅ 扩展激活开始/完成/失败
- ✅ 扩展停用
- ✅ 组件初始化状态

### 索引管理
- ✅ 索引构建开始/完成
- ✅ 索引重建触发原因和结果
- ✅ 扫描的文件数量和处理时间
- ✅ 索引大小统计

### 配置变更
- ✅ 配置项变更检测
- ✅ 自动重建索引触发
- ✅ 日志级别动态调整

### 文件监听
- ✅ 文件变更/添加/删除事件
- ✅ 文件是否在扫描范围内的判断
- ✅ 排除模式匹配结果

### 属性导航
- ✅ 配置键查找和跳转操作
- ✅ 多位置选择对话框显示
- ✅ 文件打开成功/失败

### 错误处理
- ✅ 详细的错误堆栈信息
- ✅ 操作上下文信息
- ✅ 用户友好的错误提示

## 查看日志

### 方法1：通过输出面板
1. 打开VS Code
2. 按 `Ctrl+Shift+U` (Windows/Linux) 或 `Cmd+Shift+U` (Mac) 打开输出面板
3. 在输出面板的下拉菜单中选择 "Java Properties Navigator"

### 方法2：通过命令面板
1. 按 `Ctrl+Shift+P` (Windows/Linux) 或 `Cmd+Shift+P` (Mac) 打开命令面板
2. 输入 "Output: Show Output Channels"
3. 选择 "Java Properties Navigator"

## 日志示例

### 扩展激活日志
```
[2024-01-15T10:30:00.123Z] [INFO] Java Properties Navigator 扩展开始激活
[2024-01-15T10:30:00.125Z] [INFO] 日志管理器已初始化
[2024-01-15T10:30:00.130Z] [INFO] 正在创建配置索引管理器
[2024-01-15T10:30:00.135Z] [INFO] 开始初始化配置索引管理器
[2024-01-15T10:30:00.200Z] [INFO] 性能监控 - 配置索引初始化
数据: {
  "duration": "65ms"
}
[2024-01-15T10:30:00.205Z] [INFO] Java Properties Navigator 扩展激活完成
```

### 索引重建日志
```
[2024-01-15T10:35:00.100Z] [INFO] 开始重建配置索引
[2024-01-15T10:35:00.105Z] [DEBUG] 索引重建配置
数据: {
  "scanDirs": ["src/main/resources", "**/src/main/resources"],
  "excludePatterns": ["**/target/**", "**/build/**"],
  "fileExtensions": [".properties", ".yml", ".yaml"]
}
[2024-01-15T10:35:00.300Z] [INFO] 性能监控 - 索引重建
数据: {
  "duration": "195ms"
}
[2024-01-15T10:35:00.305Z] [INFO] 索引重建完成
数据: {
  "属性键数量": 156,
  "扫描文件数": 12
}
```

### 配置键跳转日志
```
[2024-01-15T10:40:00.100Z] [INFO] 开始跳转到配置键定义
数据: {
  "key": "server.port"
}
[2024-01-15T10:40:00.105Z] [INFO] 跳转到配置键定义
数据: {
  "key": "server.port",
  "location": "/path/to/application.properties"
}
```

## 故障排除

### 日志不显示
1. 检查日志级别设置是否过高
2. 确认输出通道选择正确
3. 尝试重新激活扩展

### 性能问题
1. 查看性能监控日志，识别耗时操作
2. 检查扫描目录配置是否合理
3. 考虑添加更多排除模式

### 配置问题
1. 查看配置变更日志
2. 检查配置项格式是否正确
3. 尝试重置为默认配置

## 开发者信息

如果您在使用过程中遇到问题，请：
1. 设置日志级别为 `DEBUG`
2. 重现问题
3. 复制相关日志信息
4. 在GitHub仓库中提交Issue

日志系统将帮助我们更快地定位和解决问题。 